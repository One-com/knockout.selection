<!doctype html>
<html>
    <head>
        <title>Selection Demo</title>
        <meta charset="utf-8">
        <style>
            ul {
                -webkit-user-select: none;
                -moz-user-select: none;
                -o-user-select: none;
                user-select: none;
            }

            .focused {
                outline: 1px solid grey;
            }

            .selected {
                color: white;
                background-color: lightgrey;
            }
        </style>
    </head>
    <body>
        <div id="single">
            <h1>Single selection</h1>
            <ul data-bind="foreach: items, selection: { selection: selection, mode: 'single' }" tabindex="-1">
                <li data-bind="text: text, css: { selected: selected }" unselectable="on"></li>
            </ul>
        </div>

        <div id="single-horizontal">
            <h1>Single selection, horizontal</h1>
            <div data-bind="foreach: items, selection: { selection: selection, mode: 'single', direction: 'horizontal' }" tabindex="-1">
                <span data-bind="text: text, css: { selected: selected }" unselectable="on"></span>
            </div>
        </div>

        <div id="toggle">
            <h1>Toggle selection</h1>
            <ul data-bind="foreach: items, selection: { selection: selection, mode: 'toggle' }" tabindex="-1">
                <li data-bind="text: text, css: { selected: selected, focused: focused }" unselectable="on"></li>
            </ul>
        </div>

        <div id="off">
            <h1>Selection off</h1>
            <ul data-bind="foreach: items, selection: { selection: selection, mode: 'off' }" tabindex="-1">
                <li data-bind="text: text, css: { selected: selected, focused: focused }" unselectable="on"></li>
            </ul>
        </div>

        <div id="multi">
            <h1>Multiple selections</h1>
            <ul data-bind="foreach: items, selection: { selection: selection, focused: focused }" tabindex="-1">
                <li data-bind="text: text, css: { selected: selected, focused: focused }" unselectable="on"></li>
            </ul>
        </div>

        <div id="multi-nested">
            <h1>Multiple selections with nested scoping</h1>
            <ul data-bind="foreach: items, selection: { selection: selection, focused: focused }" tabindex="-1">
                <li data-bind="css: { selected: selected, focused: focused }" unselectable="on">
                    <span data-bind="text: text" unselectable="on"></span>
                    <ul data-bind="foreach: ['Sub-item 1', 'Sub-item 2', 'Sub-item 3']" unselectable="on">
                        <li data-bind="text: $data" unselectable="on"></li>
                    </ul>
                </li>
            </ul>
        </div>

        <div id="multi-horizontal">
            <h1>Multiple selections, horizontal</h1>
            <div data-bind="foreach: items, selection: { selection: selection, focused: focused, direction: 'horizontal' }" tabindex="-1">
                <span data-bind="text: text, css: { selected: selected, focused: focused }" unselectable="on"></span>
            </div>
        </div>

        <div id="template">
            <h1>Template selection</h1>
            <ul data-bind="template: { foreach: items, name: 'items-template' }, selection: selection" tabindex="-1"></ul>
        </div>

        <div id="dynamic">
            <h1>Switching selection mode on-the-fly</h1>
            <select data-bind="options: modes, value: mode"></select>
            <ul data-bind="foreach: items, selection: { selection: selection, mode: mode }" tabindex="-1">
                <li data-bind="text: text, css: { selected: selected, focused: focused }" unselectable="on"></li>
            </ul>
        </div>

        <div id="subset">
            <h1>Subset selection (items with even index)</h1>
            <ul data-bind="foreach: items, selection: { selection: selection, data: selectable,  mode: 'toggle' }" tabindex="-1">
                <li data-bind="text: text, css: { selected: selected, focused: focused }" unselectable="on"></li>
            </ul>
        </div>

        <script type="text/html" id="items-template">
            <li data-bind="text: text, css: { selected: selected, focused: focused }" unselectable="on"></li>
        </script>

        <script src="../vendor/knockout-3.0.0.debug.js"></script>
        <script src="../lib/eventmatcher.js"></script>
        <script src="../lib/knockout.selection.js"></script>
        <script>
            function createItems(size) {
                var result  = [];

                for (var i = 0; i < size; i += 1) {
                    result.push({
                        text: 'Item ' + (i + 1),
                        selected: ko.observable(false),
                        focused: ko.observable(false)
                    });
                }
                return result;
            }

            /**
             * Create a simple selection model that only allows
             * selecting a single item at a time.
             */
            var singleSelection = {
                    items: ko.observableArray(createItems(10)),
                    selection: ko.observableArray()
                };

            ko.applyBindings(singleSelection, window.document.getElementById('single'));

            /**
             * Create a simple selection model that only allows
             * selecting a single item at a time.
             */
            var singleHorizontalSelection = {
                    items: ko.observableArray(createItems(10)),
                    selection: ko.observableArray()
                };

            ko.applyBindings(singleHorizontalSelection, window.document.getElementById('single-horizontal'));

            /**
             * Create a toggle selection model that allows selecting
             * multiple items by toggling them.
             */
            var toggleSelection = {
                    items: ko.observableArray(createItems(10)),
                    selection: ko.observableArray()
                };

            ko.applyBindings(toggleSelection, window.document.getElementById('toggle'));

            /**
             * Create an off selection model that does not allow selecting items.
             */
            var offSelection = {
                    items: ko.observableArray(createItems(10)),
                    selection: ko.observableArray()
                };

            ko.applyBindings(offSelection, window.document.getElementById('off'));

            /**
             * Allow multiple selections with a focused item.
             */
            var multiSelection = {
                    items: ko.observableArray(createItems(10)),
                    selection: ko.observableArray(),
                    focused: ko.observable()
                };

            ko.applyBindings(multiSelection, window.document.getElementById('multi'));

            /**
             * Allow multiple selections with a focused item.
             */
            var multiHorizontalSelection = {
                    items: ko.observableArray(createItems(10)),
                    selection: ko.observableArray(),
                    focused: ko.observable()
                };

            ko.applyBindings(multiHorizontalSelection, window.document.getElementById('multi-horizontal'));

            /**
             * Allow multiple selections with a focused item and nested scopes.
             */
            var multiNestScopeSelection = {
                    items: ko.observableArray(createItems(5)),
                    selection: ko.observableArray(),
                    focused: ko.observable()
                };

            ko.applyBindings(multiNestScopeSelection, window.document.getElementById('multi-nested'));

            /**
             * Using a template is the same as others. To spice things up
             * a bit we programmatically set the selection.
             */
            var templateSelection = {
                    items: ko.observableArray(createItems(10)),
                    selection: ko.observableArray()
                };

            // Programmatically set the selection to the 5th and 8th item
            templateSelection.selection([templateSelection.items()[4], templateSelection.items()[7]]);

            ko.applyBindings(templateSelection, window.document.getElementById('template'));

            /**
             * Change selection modes on the fly
             */
            var dynamicSelection = {
                    items: ko.observableArray(createItems(10)),
                    selection: ko.observableArray(),
                    mode: ko.observable('single'),
                    modes: [
                        'single',
                        'toggle',
                        'off',
                        'multi'
                    ]
                };

            ko.applyBindings(dynamicSelection, window.document.getElementById('dynamic'));

            /**
             * Selecting in a subset of the listed items, in this case the items with even indexes
             */
            var subsetSelection = {
                    items: ko.observableArray(createItems(10)),
                    selection: ko.observableArray()
                };
                subsetSelection.selectable = ko.computed(function () {
                    return ko.utils.arrayFilter(subsetSelection.items(), function (item) {
                        return subsetSelection.items.indexOf(item) % 2 === 0;
                    });
                });

            ko.applyBindings(subsetSelection, window.document.getElementById('subset'));

        </script>
    </body>
</html>
